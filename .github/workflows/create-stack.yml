name: create arm64 stack

on:
  workflow_dispatch:

jobs:
  build:

    runs-on: ARM64

    steps:
          
      - name: Checkout
        uses: actions/checkout@v2
        
      - name: Login to DockerHub
        uses: docker/login-action@v2
        with:
          username: ${{ secrets.DOCKERHUB_USERNAME }}
          password: ${{ secrets.DOCKERHUB_TOKEN }}

      - name: create-stack
        run: |
          docker build ./stack -t dashaun/stack-build:tiny --target build --build-arg STACK_ID="io.paketo.stacks.tiny"
          docker push dashaun/stack-build:tiny
  
          docker build ./stack -t dashaun/stack-run:tiny --target run --build-arg STACK_ID="io.paketo.stacks.tiny"
          docker push dashaun/stack-run:tiny